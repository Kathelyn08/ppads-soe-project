{% extends 'base.html' %}

{% block title %}Minhas Metas{% endblock %}

{% block content %}
<div class="p-3 bg-dark text-light min-vh-100">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h4 class="text-light"><i class="bi bi-bullseye"></i> Minhas Metas</h4>
        <a href="{% url 'meta-create' %}" class="btn btn-warning">
            <i class="bi bi-plus-circle"></i> Nova Meta
        </a>
    </div>

    <div class="card mb-4 bg-secondary border-0">
        <div class="card-body">
            <form method="get">
                <div class="d-flex text-light gap-3 align-items-end">
                    {{ form }}

                    <div>
                        <button type="submit" class="btn btn-outline-warning me-2">Filtrar</button>
                        <a href="{% url 'meta-list' %}" class="btn btn-outline-light">Limpar</a>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <div class="card mb-4 bg-secondary border-0">
        <div class="card-body">
            <h2 class="text-light">
                {{ total }} meta{{ total|pluralize }}
            </h2>

            <div class="progress mb-2" role="progressbar" aria-label="Basic example" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                <div class="progress-bar" style="width: {{ progresso|floatformat:"u" }}%"></div>
            </div>

            <h6 class="text-light">
                {{ concluido }} meta{{ concluido|pluralize }} concluída{{ concluido|pluralize }}
            </h6>
        </div>
    </div>

    {% if metas %}
        {% for meta in metas %}
        <div class="card mb-3 bg-secondary border-0">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                         <h5 class="card-title text-light">
                             {% if meta.disciplina %}
                                 {{ meta.disciplina }}:
                             {% endif %}

                             {{ meta.alvo }}h
                        </h5>

                         <p class="card-text text-light mb-2">
                            {{ meta.data_inicial|date:"d M y G:i" }}

                             -

                             {% if meta.data_final %}
                                 {{ meta.data_final|date:"d M y G:i" }}
                             {% else %}
                                 Em andamento
                             {% endif %}

                             {% if meta.status %}
                                 <span class="badge text-bg-{{ meta.color }}">
                                     {{ meta.status }}
                                 </span>
                             {% endif %}
                        </p>

                        <p class="card-text text-light-emphasis mb-2">
                            {% if meta.descricao %}
                                {{ meta.descricao }}
                            {% else %}
                                <em>Sem descrição</em>
                            {% endif %}
                        </p>
                    </div>
                    
                    <div class="btn-group ms-3">
                        <a href="{% url 'meta-update' meta.pk %}" class="btn btn-sm btn-outline-warning">
                            <i class="bi bi-pencil"></i>
                        </a>
                        <a href="{% url 'meta-delete' meta.pk %}" class="btn btn-sm btn-outline-danger">
                            <i class="bi bi-trash"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}

    {% else %}
        <div class="text-center py-5">
            <i class="bi bi-book display-1 text-light-emphasis mb-3"></i>
            <h3 class="text-light-emphasis">Nenhuma meta encontrada</h3>
            <p class="text-light-emphasis">Comece criando sua primeira meta!</p>
            <a href="{% url 'meta-create' %}" class="btn btn-warning">
                <i class="bi bi-plus-circle"></i> Criar Primeira Meta
            </a>
        </div>
    {% endif %}
</div>

<style>
.bg-dark {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%) !important;
}

.bg-secondary {
    background-color: #2d3748 !important;
}

.card {
    transition: all 0.3s ease;
    border-radius: 10px;
}

.card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
}

.form-select:focus {
    background-color: #2d3748;
    border-color: #ecc94b;
    box-shadow: 0 0 0 0.2rem rgba(236, 201, 75, 0.25);
    color: #ffffff;
}

.btn-outline-warning {
    border-color: #ecc94b;
    color: #ecc94b;
}

.btn-outline-warning:hover {
    background-color: #ecc94b;
    color: #1a202c;
    border-color: #ecc94b;
}

.btn-outline-light {
    border-color: #a0aec0;
    color: #a0aec0;
}

.btn-outline-light:hover {
    background-color: #a0aec0;
    color: #1a202c;
    border-color: #a0aec0;
}

.text-light-emphasis {
    color: #a0aec0 !important;
}

.border-secondary {
    border-color: #4a5568 !important;
}

.page-link {
    border-radius: 6px;
    margin: 0 2px;
}

.page-link:hover {
    background-color: #4a5568 !important;
    border-color: #ecc94b;
}
</style>

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
{% endblock %}
